/*
komodo tool: includeFileTreeLinks
=================================
async: False
is_clean: true
language: JavaScript
rank: 100
trigger: trigger_postopen
trigger_enabled: False
type: macro
version: 1.1.5
=================================*/
/* Clear Console */

var console_pane=document.getElementById("console-widget");if(console_pane)console_pane.contentWindow.document.getElementById("output").innerHTML="";else{var e=require("ko/windows").getAll();for(let n=0;n<e.length;n++)if("console-widget"==e[n].name){var o=e[n].document.getElementById("output");o&&(o.innerHTML="")}};



/** 
 */
function includeFileTreeLinks(){
	new ko.extensions.vilbur.markdown.MarkdownLinker()
			.heading('## Import file tree', '# All Content On This Page Is Generated With MarkdownLinker')
			.link()			
			.html() // Display links as HTML -- allows coloring of text
			.show('name') // display text by "name|dir|path" INIT:name
			.tree()
			.include();
			//.mask('.*\.ahk$')
			//.matchDirName() // include only files which pranet folder is same as filename E.G.: '\Foo\foo.ms'
			//.update()
}
 

/** 
 */
function linksToAhkFilesWithoutTree(){
	new ko.extensions.vilbur.markdown.MarkdownLinker()
			.heading('Links to ahk files without tree')
			.link()			
			.extension('ahk')
			.indentation() // Allow indentation
			.maxLevel( 4 ) // Max depth to search in hierarchy null|integer INIT:infinite DEFAULT:1
			.include();
}

 

/** 
 */
function dirsWithReadmeFile(){
	new ko.extensions.vilbur.markdown.MarkdownLinker()
			.heading('Dirs with readme file')
			.link()			
			.extension('md')
			.maxLevel( 4 )
			.filter('dir')  // "null|file|dir" > Show files, dirs or both if null 
			.show('dir') // display only directories
			.include();
}

/** 
 */
function showImage(){
	new ko.extensions.vilbur.markdown.MarkdownLinker()
			.heading('Show Image')
			.image() // Interprets link to image as image
			.extension('ico')
			.filter('file') // display only files
			.link(false)			
			.include();
}

/** 
 */
function showImageWithLink(){
	new ko.extensions.vilbur.markdown.MarkdownLinker()
			.heading('Link And Show Images')
			.image() // Interprets link to image as image
			.extension('png')
			.filter('file') // display only files
			.include();
}

/** 
 */
function importCodeBlock(){
	new ko.extensions.vilbur.markdown.MarkdownLinker()
			.heading('Link To Code Blocks - [Compiled with MarkdownFormatter]( https://github.com/vilbur/KOMODO-AppData/tree/master/tools/Scripts/Markdown/markdownFormatter )\n')
			.codeBlock() // Interprets link to image as image
			.extension('js')
			.maxLevel( 4 )
			.filter('file') // display only files
			.include();
}



includeFileTreeLinks();

//require("ko/editor").insert('\n\n');
require("ko/editor").insert('\n\n------------------------------------------------------------------------------------\n\n');

linksToAhkFilesWithoutTree();

//require("ko/editor").insert('\n\n');
require("ko/editor").insert('\n\n------------------------------------------------------------------------------------\n\n');

dirsWithReadmeFile();

//require("ko/editor").insert('\n\n');
require("ko/editor").insert('\n\n------------------------------------------------------------------------------------\n\n');

importCodeBlock();

//require("ko/editor").insert('\n\n');
require("ko/editor").insert('\n\n------------------------------------------------------------------------------------\n\n');

showImage();

//require("ko/editor").insert('\n\n');
require("ko/editor").insert('\n\n------------------------------------------------------------------------------------\n\n');

showImageWithLink();
